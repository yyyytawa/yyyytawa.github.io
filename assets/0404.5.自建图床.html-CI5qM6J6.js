import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as e,o as n}from"./app-C0kqeCZw.js";const t={};function l(p,s){return n(),a("div",null,[...s[0]||(s[0]=[e(`<h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述"><span>概述:</span></a></h2><p>图床对于一个文档来说是必不可少的一部分,对于markdown来说也非常重要,毕竟要插入图片之类的.本教程教你如何用自己的服务器自建图床.<br> 本教程中将使用Caddy作为web服务端,系统为debian12.你也可以选择使用NGINX和其他系统.<br> 本教程只写了80,443可用的情况,实际情况可能会更复杂.</p><h3 id="_1-安装caddy" tabindex="-1"><a class="header-anchor" href="#_1-安装caddy"><span>1.安装Caddy</span></a></h3><p>非常简单,几行命令就能解决.</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> debian-keyring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> debian-archive-keyring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt-transport-https</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> curl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -1sLf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;https://dl.cloudsmith.io/public/caddy/stable/gpg.key&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gpg</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --dearmor</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/share/keyrings/caddy-stable-archive-keyring.gpg</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -1sLf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tee</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/apt/sources.list.d/caddy-stable.list</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> caddy</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果出现像下面这个属于正常现象,无需理会</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">unable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> resolve</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxxxx:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> No</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> address</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> associated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hostname</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>接下来你可以直接访问你的服务器的IP,不出意外的话你应该能看到Caddy的欢迎界面了.<br><img src="https://img.yyyyt.top/docs/articles/tech/2025/5/welcome_to_caddy.png" alt="Welcome_to_Caddy" loading="lazy"><br> 界面上甚至贴心备注如何开启https.</p><h3 id="_2-配置caddy" tabindex="-1"><a class="header-anchor" href="#_2-配置caddy"><span>2.配置Caddy</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>建议先把对应域名解析到你的服务器,方便Caddy自动申请证书,请确保80端口可以被外部访问.当然你可以使用dns的方式来申请,不过限于篇幅不会展示.</p></div><p>首先打开你的sftp软件,到 <code>/etc/caddy</code> , 你会看到一个叫 <code>Caddyfile</code> 的文件,非常简洁的写法.<br> 但是默认配置是都在一个Caddyfile里面的,多了非常不利于我们去整理,所以我们要略微改一下.</p><p>创建一个文件夹,就叫 <code>site</code> <s>(其实你可以换成别的,记得把下文教程中的路径换成你自己的)</s><br> 在Caddyfile的后面加上一个 <code>import /etc/caddy/site/*.conf</code>,如下图所示.</p><p>接下来只需要把配置文件丢到site目录下即可.</p><p>建议加上邮箱相关配置来方便Caddy自动申请https证书.</p><div class="language-caddyfile line-numbers-mode" data-highlighter="shiki" data-ext="caddyfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-caddyfile"><span class="line"><span>{</span></span>
<span class="line"><span>    email example@example.com  # 替换为你的邮箱地址</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接下来在site目录里面创建一个 <code>images.conf</code> 内容如下:</p><div class="language-conf line-numbers-mode" data-highlighter="shiki" data-ext="conf" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-conf"><span class="line"><span>img.example.com { # 替换为你的域名</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	# 设置为你的图片保存目录</span></span>
<span class="line"><span>	root * /www/images</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	# 启动静态文件服务</span></span>
<span class="line"><span>	file_server</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	header Cache-Control &quot;public, max-age=31536000&quot; # 缓存时间按照自己需求设定,可以影响cdn缓存的时间</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>记得创建对应目录.</p></div><p>重载Caddy: <code>sudo systemctl reload caddy</code></p><p>接下来Caddy会自动通过http方式申请证书,一般一分钟内就会申请成功.<br> Caddy默认开启http重定向https, HTTP/2和HTTP/3,这点好评.</p><h3 id="_3-使用" tabindex="-1"><a class="header-anchor" href="#_3-使用"><span>3.使用</span></a></h3><p>将你的图片上传到 <code>/www/images</code> 即可,例如说目录为 /www/images/example.png 那么你应该使用 <a href="https://img.example.com/example.png" target="_blank" rel="noopener noreferrer">https://img.example.com/example.png</a> 访问到这个图片.<br> 你也可以开启cdn来缓存图片,不过这是后话了.</p><h2 id="the-end" tabindex="-1"><a class="header-anchor" href="#the-end"><span>The End</span></a></h2>`,23)])])}const r=i(t,[["render",l]]),k=JSON.parse(`{"path":"/articles/tech/2025/0404.5.%E8%87%AA%E5%BB%BA%E5%9B%BE%E5%BA%8A.html","title":"5.自建图床","lang":"zh-CN","frontmatter":{"title":"5.自建图床","order":-260,"description":"概述: 图床对于一个文档来说是必不可少的一部分,对于markdown来说也非常重要,毕竟要插入图片之类的.本教程教你如何用自己的服务器自建图床. 本教程中将使用Caddy作为web服务端,系统为debian12.你也可以选择使用NGINX和其他系统. 本教程只写了80,443可用的情况,实际情况可能会更复杂. 1.安装Caddy 非常简单,几行命令就能...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"5.自建图床\\",\\"image\\":[\\"https://img.yyyyt.top/docs/articles/tech/2025/5/welcome_to_caddy.png\\"],\\"dateModified\\":\\"2025-04-04T06:38:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"yyyyt\\",\\"url\\":\\"https://docs.yyyyt.top/site/about_me\\"}]}"],["meta",{"property":"og:url","content":"https://docs.yyyyt.top/articles/tech/2025/0404.5.%E8%87%AA%E5%BB%BA%E5%9B%BE%E5%BA%8A.html"}],["meta",{"property":"og:site_name","content":"yyyyt的文档站"}],["meta",{"property":"og:title","content":"5.自建图床"}],["meta",{"property":"og:description","content":"概述: 图床对于一个文档来说是必不可少的一部分,对于markdown来说也非常重要,毕竟要插入图片之类的.本教程教你如何用自己的服务器自建图床. 本教程中将使用Caddy作为web服务端,系统为debian12.你也可以选择使用NGINX和其他系统. 本教程只写了80,443可用的情况,实际情况可能会更复杂. 1.安装Caddy 非常简单,几行命令就能..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://img.yyyyt.top/docs/articles/tech/2025/5/welcome_to_caddy.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-04T06:38:50.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-04T06:38:50.000Z"}]]},"git":{"createdTime":1743748730000,"updatedTime":1743748730000,"contributors":[{"name":"yyyytawa","username":"yyyytawa","email":"116234899+yyyytawa@users.noreply.github.com","commits":1,"avatar":"https://avatars.githubusercontent.com/yyyytawa?v=4","url":"https://github.com/yyyytawa"}]},"readingTime":{"minutes":2.38,"words":715},"filePathRelative":"articles/tech/2025/0404.5.自建图床.md","excerpt":"<h2>概述:</h2>\\n<p>图床对于一个文档来说是必不可少的一部分,对于markdown来说也非常重要,毕竟要插入图片之类的.本教程教你如何用自己的服务器自建图床.<br>\\n本教程中将使用Caddy作为web服务端,系统为debian12.你也可以选择使用NGINX和其他系统.<br>\\n本教程只写了80,443可用的情况,实际情况可能会更复杂.</p>\\n<h3>1.安装Caddy</h3>\\n<p>非常简单,几行命令就能解决.</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-bash\\"><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">sudo</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> apt</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -y</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> debian-keyring</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> debian-archive-keyring</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> apt-transport-https</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> curl</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">curl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -1sLf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> | </span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">sudo</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> gpg</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --dearmor</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -o</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /usr/share/keyrings/caddy-stable-archive-keyring.gpg</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">curl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -1sLf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> | </span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">sudo</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> tee</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /etc/apt/sources.list.d/caddy-stable.list</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">sudo</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> apt</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> update</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">sudo</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> apt</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> caddy</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{r as comp,k as data};
